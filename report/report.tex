\documentclass[a4paper, article, oneside, USenglish, IN5460]{memoir}

\input{style/import}

\title{Appliance Energy Consumption Prediction and Classification Using Federated Learning}
\authors{F. Ofstad, Z. Shan, R. Syed, H. Zhang}

\addbibresource{bibliography.bib}

\begin{document}

\projectfrontpage


\chapter{Introduction}

The purpose of this report is to construct a Federated Learning model, which aggregates the resulting weights from client models. The client models have two tasks:
\begin{enumerate}
    \item to train a model to predict the energy consumption for appliances in a household
    \item Train a model to classify the type of appliance based on their energy consumption.    
\end{enumerate}

To this end, we used the tensorflow package for Python when creating the client models using Keras, and the extension tensorflow federated for the aggregating model. The steps the program takes are as follows. 


\section{Pre-processing the data}
We first convert the provided excel file into csv files for each household. This is done to conceptually emulate FL as each client should only have access to their own data, and because CSV files are generally faster to load in python.

Then for the prediction model, the data is processed as follows:
The applications energy consumption is summed up per period, creating a time-series dataset. This data set is segmented into pairs of seven day inputs, with the eight day being the output.

For the classification model.

\section{Training the models}

The clients themselves utilize RNN and LSTM models with n layers and n nodes #TODO-FILLIN

The federated model runs these clients and extracts the averaged weights which it used for the aggregated model.



\chapter{Predicting Appliance Energy Consumption}

The following section tests the federated learning efficiency when predicting appliance energy consumption.

\section{Prediction with RNN}

\begin{figure}[H]
  \centering
    \input{report/figures/pred-rnn-loss}
  \caption{Simulation plot of the training error in MSE}
\end{figure}

\begin{figure}[H]
  \centering
    \input{report/figures/pred-rnn-train}
  \caption{Simulation plot of the training error in MSE}
\end{figure}

I dunno mannnn

\begin{figure}[H]
  \centering
    \input{report/figures/pred-rnn-test}
  \caption{Simulation plot comparing the predicted value with the ground truth}
\end{figure}


%Is the federated learning efficient in this scenario of appliance energy consumption prediction? Please discuss whether the performance of model training can be improved by adding more epochs or through other configuration changes.


\section{Prediction with LSTM}

The following models use the same configurations as the previous model, except the trainer uses LSTM instead of regular RNN.

\begin{figure}[H]
  \centering
    \input{report/figures/pred-lstm-loss}
  \caption{Simulation plot of the training error in MSE}
\end{figure}


\begin{figure}[H]
  \centering
    \input{report/figures/pred-lstm-test}
  \caption{Simulation plot comparing the predicted value with the ground truth}
\end{figure}

 %Compare the performance with that of RNN regarding execution time and prediction error during the test.

\chapter{Classifying Appliance Types}

This section reports the results of the classification model: determining the types of application based on the daily consumption of an appliance.

\section{Classification using Regular RNN}

%Is the federated learning efficient in this scenario of appliance classification? Please use simulation plots to show the classification accuracy during the training process using training (or training and validation) data, and show the classification accuracy of the trained model using test data. Please discuss whether the accuracy during the training and testing can be improved by adding more epochs or through other configuration changes.

\section{Confusion Matrix}

%The accuracy in Question 2.1 manifests how the model works for all the appliance as a whole.You also need to show how the classification works for each appliance. To do so, you need to generate the confusion matrix of the classification result, both for the model training and testing. The confusion matrix should present the classification accuracy for each appliance.

\section{Classification using LSTM}

%Keep the same settings as in Question 2.1 and 2.2, except that you use LSTM when implementing federated learning. You then show the simulation plots as required in Question 2.1 and 2.2, and compare with the results when using RNN.

\chapter{Conclusion}

In conclusion, Why is it so hard to make intuitive code that just works?? Google, you're a multi-billion dollar company.. please! 
\newpage

\nocite{tensorflow2015-whitepaper}
\nocite{dataset}

\printbibliography{}

\vspace*{10mm}
\end{document}